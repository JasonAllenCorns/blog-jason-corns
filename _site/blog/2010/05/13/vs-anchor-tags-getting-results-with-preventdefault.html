<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>Jason vs. Anchor Tags – Getting Results with the preventDefault method</title>
    <meta name="description" content="In another post, Jason vs. Page Weight – Accessibility Series, pt. 2, I talked about a solving page weight problem I had with a client.">
    <link rel="shortcut icon" href="/img/favicon.ico?v=2"/>
    <link rel="stylesheet" href="/css/main.css">
    <link rel="stylesheet" href="/assets/css/bootstrap.min.css">
    <link rel="canonical" href="http://jasoncorns.com/blog/2010/05/13/vs-anchor-tags-getting-results-with-preventdefault.html">
    <link rel="alternate" type="application/rss+xml" title="jasoncorns.com" href="http://jasoncorns.com/feed.xml">
</head>


<body>
<div class="container-fluid" id="wrapper">
    <div class="row" id="page-wrapper">
        <div class="col-xs-12 col-md-10 col-md-push-2 bg-gray blog-tiles">
            <article class="post" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title" itemprop="name headline">Jason vs. Anchor Tags – Getting Results with the preventDefault method</h1>
    <p class="post-meta"><time datetime="2010-05-13T19:22:49-07:00" itemprop="datePublished">May 13, 2010</time> • <span itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name">jason_corns</span></span></p>
  </header>

  <div class="post-content" itemprop="articleBody">
    <p>In another post, <a href="/blog/accessibility/2010/04/26/vs-page-weight-accessibility-part-2.html">Jason vs. Page Weight – Accessibility Series, pt. 2</a>, I talked about a solving page weight problem I had with a client.<!--more-->  In the end, the client decided to put a lot of data on a single page.  In my opinion, this would have been a great time to use AJAX to pull in the data rather than just pushing it all to the page at load.  The problem with AJAX is that it relies on JavaScript (reliance may, in fact, be too weak a term, honestly) and so would not have been ideal for search engines and would not have provided accessible page content.  We could fix that by linking to pages with additional content, but we really want to use AJAX to show the data on a single page for all visitors with JavaScript enabled.  So, we just do both.</p>

<p>By leveraging the <a href="http://api.jquery.com/category/events/event-object/#post-201">preventDefault method</a> available in the jQuery library (this is actually a JavaScript call, and exists outside of jQuery.  See the <a href="http://www.w3.org/TR/2001/WD-DOM-Level-3-Events-20010823/events.html#Events-Event-preventDefault">W3C write up</a>.) we can provide a page that is static, accessible HTML content by default, but picks up some dynamic interest at page load.  Note: some of the following examples presuppose a single domain; using AJAX to load content from other pages can easily get into <a href="http://en.wikipedia.org/wiki/Cross-site_scripting">cross-site scripting</a> issues.  If you control the server being accessed, you can manage the cross-origin request permissions by setting the <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Access_control_CORS">HTTP access control</a>.</p>

<p>Take the following HTML code for example:</p>

<figure class="highlight"><pre><code class="language-html" data-lang="html"><span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"targetLinks"</span><span class="nt">&gt;</span>
	<span class="nt">&lt;ul&gt;</span>
		<span class="nt">&lt;li&gt;&lt;a</span> <span class="na">href=</span><span class="s">"somepage.html"</span><span class="nt">&gt;</span>Some Page<span class="nt">&lt;/a&gt;&lt;/li&gt;</span>
		<span class="nt">&lt;li&gt;&lt;a</span> <span class="na">href=</span><span class="s">"anotherpage.html"</span><span class="nt">&gt;</span>Another Page<span class="nt">&lt;/a&gt;&lt;/li&gt;</span>
	<span class="nt">&lt;/ul&gt;</span>
<span class="nt">&lt;/div&gt;</span></code></pre></figure>

<p>No magic here.  Two links to two different pages (for simplicity, these are two pages within the same domain).</p>

<h2 id="the-task">The Task</h2>

<p>Our task is to display content from a different page in a modal dialog.  Just to make it more fun, we’ll pull a specific part of the target page in our modal (denoted in each page by a div with ID of “target”).  To add that last little bit of shine to the action, we’ll prevent the URL from changing (more appropriately, we’ll stop any calls to change the <em>window location</em>).</p>

<p>We’ll need three things for this tutorial:</p>

<ul>
  <li><a href="http://jquery.com">jQuery</a></li>
  <li><a href="https://jqueryui.com/">jQueryUI</a> - <em>core</em> plus <em>dialog</em> will do (for a simple Modal)</li>
</ul>

<p>Let’s take a look at the code required to attain our goal, then we’ll break it down piece by piece.</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="nx">$</span><span class="p">(</span><span class="nb">document</span><span class="p">).</span><span class="nx">ready</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
	<span class="nx">$</span><span class="p">(</span><span class="s1">'.targetLinks'</span><span class="p">).</span><span class="nx">find</span><span class="p">(</span><span class="s1">'ul li a'</span><span class="p">).</span><span class="nx">on</span><span class="p">(</span><span class="s1">'click'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">eventMarker</span><span class="p">)</span> <span class="p">{</span>
		<span class="kd">var</span> <span class="nx">$dialog</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="s1">'&lt;div&gt;&lt;/div&gt;'</span><span class="p">)</span>
			<span class="p">.</span><span class="nx">load</span><span class="p">(</span><span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'href'</span><span class="p">)</span> <span class="o">+</span> <span class="s2">" #target"</span><span class="p">)</span>
			<span class="p">.</span><span class="nx">dialog</span><span class="p">({</span>
				<span class="na">autoOpen</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
				<span class="na">modal</span><span class="p">:</span><span class="kc">true</span><span class="p">,</span>
				<span class="na">title</span><span class="p">:</span> <span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'title'</span><span class="p">),</span>
				<span class="na">width</span><span class="p">:</span> <span class="mi">500</span><span class="p">,</span>
				<span class="na">height</span><span class="p">:</span> <span class="mi">300</span>
			<span class="p">});</span>
		<span class="nx">$dialog</span><span class="p">.</span><span class="nx">dialog</span><span class="p">(</span><span class="s1">'open'</span><span class="p">);</span>
		<span class="nx">eventMarker</span><span class="p">.</span><span class="nx">preventDefault</span><span class="p">();</span>
	<span class="p">});</span>
<span class="p">});</span></code></pre></figure>

<p>If you’ve seen jQuery snippets before, you should be familiar with the <em>$(document.ready)</em>, which executes the wrapped code only after the document has finished loading.</p>

<p><code class="highlighter-rouge">$('.targetLinks').find('ul li a').on('click', function(eventMarker) {</code></p>

<p>This line of code does two things:</p>

<ol>
  <li>Traverses the DOM to find the elements with class “targetLinks” that also contain the UL LI A descendant path and establishes a jQuery array of elements representing the matched <code class="highlighter-rouge">&lt;a&gt;</code> tags.</li>
  <li>Assigns a click event to each <code class="highlighter-rouge">&lt;a&gt;</code> in the returned array of elements.  The click event is an anonymous function that takes the DOM Event and assigns it to an argument called “eventMarker”.</li>
</ol>

<p><code class="highlighter-rouge">var $dialog = $('&lt;div&gt;&lt;/div&gt;')</code></p>

<p>Next, we establish a variable, <em>$dialog</em>, as a pointer to a newly created DIV element. Why a new div? The jQuery UI dialog, like many other jQuery plugins, destroy the element used as the selector when the dialog closes.  We could target an existing DIV as the dialog, but when the modal closes, the existing DIV will be destroyed (lost for all script).</p>

<p><code class="highlighter-rouge">.load($(this).attr('href') + " #target")</code></p>

<p>We continue the method chain, established on our newly created div, by calling the jQuery .load() method.  Load expects a URL (same site URI, of course), which we have passed by calling $(this) (the clicked anchor) and calling the .attr() method asking for the href.</p>

<p><code class="highlighter-rouge">.dialog({
	autoOpen: false,
	modal:true,
	title: $(this).attr('title'),
	width: 500,
	height: 300
});</code></p>

<p>Still continuing the method chain, we call the <a href="http://jqueryui.com/demos/dialog/">.dialog()</a> method on the <code class="highlighter-rouge">$dialog</code> variable (div that was created).  This established the UI Framework necessary to make the dialog work.  We set a few options to the dialog (see the <a href="http://jqueryui.com/dialog/#options">UI documentation for the dialog</a> for more options), again referencing <em>$(this)</em> (the clicked anchor) and calling the <a href="http://api.jquery.com/attr/">.attr()</a> method asking for the title of the anchor to set to the dialog title.</p>

<p><code class="highlighter-rouge">$dialog.dialog('open');</code></p>

<p>Here, we have separated the <em>open</em> command from the dialog instantiation.  This doesn’t need to be the case, here, but may prove to be a useful practice later.  If you were waiting to see your dialog, you should see it now.</p>

<p><code class="highlighter-rouge">eventMarker.preventDefault()</code></p>

<p>This is the moment we’ve been waiting for.  We have been following happily along wherever the DOM actions will take us but now, we are going to take control of the clicked anchor tag, and force it to do what we want.  Remember, <em>eventMarker</em> is the event argument passed in initially.  Here, we are calling the JavaScript preventDefault method on the event.  Since our event is the result of the click of an anchor, the default action should be to alter the window location.  Instead, we have truncated the event prior to changing the address bar.  As you might imagine, this same method can be used for bookmark links as well – in the end, the preventDefault() method will prevent the hash from being appended to the URL.</p>

<h3 id="why-preventdefault-instead-of-return-false">Why <em>preventDefault()</em> instead of return false;?</h3>

<p>Whenever  you run a return from a JavaScript function, you exit the function – completely preempting any further actions.  With <em>preventDefault()</em>, further processing can be accomplished after the method call, within the same function.  Note that <em>eventMarker.stopPropogation()</em> or <em>eventMarker.cancelBubble=true</em> should be used to completely cancel event bubbling.</p>

<h3 id="so-what">So what?</h3>

<p>Why would the methods in this post be useful?  With this code,  we are unobtrusively adding click event handlers to targeted links, but we are doing so without actually coding “onclick=’…’” or setting href=”javascript:function()”.  If your visitors have <a href="http://www.webdesignerdepot.com/2010/02/how-to-plan-for-the-absence-of-javascript/">JavaScript disabled</a>, then they will get the benefit of linked content.  If JavaScript is enabled, they will get the benefit of dynamic content display, without leaving the page.  <em>Win-win</em>.</p>

  </div>

</article>

        </div>
        <div class="col-xs-12 col-md-2 col-md-pull-10 aside">
            <h2>test for echo</h2>
        </div>
    </div>
</div>

<p class="rss-subscribe">subscribe <a href="/feed.xml">via RSS</a></p>
</body>

</html>
